大数据量下分表模式  按照uid分表

tb

全局表,,uid,表路径对应


表路径对应
ip>port实例>db>tb name

mariadb,每个表是单独的文件。的。

分库后join问题。
使用子查询模式 代码join

使用零时表mode..

表的存储可以使用json文件模式，每个记录一个json
表的索引使用sqlite模式。。
表的存储也可sqlite 分表来做。。
分表更加方便，按照每个用户key文件来自动化来分表。。

# 表的命名分格  uid12345.db （acc_log_，userlib)

每个用户——业务表切分。。
只按照用户id来切分，不要切分业务表。方便join，视图等使用。。
按照用户注册时间获取它的所在库。
每个用户一个db
u23，u779,u9677
mysql原则上没有限制一个实例多少个库。


也方便跨库join，同一个实例。
以及事务。还是需要的。


# 分表后的问题 5个问题

事务尽可能不要跨库
join尽可能不要跨库。
3、跨节点分页、排序、函数问题
4、全局主键避重问题
5、数据迁移、扩容问题

当业务高速发展，面临性能和存储的瓶颈时，才会考虑分片设计，此时就不可避免的需要考虑历史数据迁移的问题。一般做法是先读出历史数据，然后按指定的分片规则再将数据写入到各个分片节点中。此外还需要根据当前的数据量和QPS，以及业务发展的速度，进行容量规划，推算出大概需要多少分片(一般建议单个分片上的单表数据量不超过1000W)
————————————————
 
尽可能按照uid来key分库分表。
可以多个用户一个库db
db_uid1_999


## DDAL（分布式数据库访问层
小结
当前主要有两类解决方案：最自由方案 user123_yewu.dbf

基于应用程序层面的DDAL（分布式数据库访问层） 

比较典型的就是淘宝半开源的TDDL，当当网开源的Sharding-JDBC等。分布式数据访问层无需硬件投入，技术能力较强的大公司通常会选择自研或参照开源框架进行二次开发和定制。对应用程序的侵入性一般较

彻底自由的数据访问，可以同时多个db使用sql,rds,mongodb,postgre,sqlite..

join需要自己join，事务跨库事务或者自己实现事务。
同时按照业务和uid分片。。。不同的user_业务可能使用不同的数据库。完全自由化的数据访问。